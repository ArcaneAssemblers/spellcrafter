start:
  - play mysterious:
  - scene: manageActions
  - show tower: WITH FADE CONTINUE
  - show deuzi: happy AT CENTER WITH FADE
  - deuzi says: A spell demands a sacrifice. Will you pay the price to begin?
  - choice:
    - "I accept":
      - deuzi says happy: One moment while your sacrifice is received..
      - deuzi says happy: A spark of magic springs to life. You're ready to begin!
      - hide deuzi: WITH FADE
      - scene: manageActions
    - "What does this mean?":
      - deuzi says: When we have a tutorial this will go here...
      - scene: start

manageActions:
  - show tower: WITH FADE
  - text: The current spell power is {power}, and its chaos is {chaos}.
  
  - if ({lightdark} > 0):
    - text: The spell is light level {lightdark}.
  - if ({lightdark} < 0):
    - var dark: "{lightdark} * -1"
    - text: The spell is dark level {dark}.

  - if ({hotcold} > 0):
    - text: The spell is hot level {hotcold}.
  - if ({hotcold} < 0):
    - var cold: "{hotcold} * -1"
    - text: The spell is cold level {cold}.

  - text: You have {barriers} barriers remaining
  - choice:
    - text: What would you like to do?
    - Forage:
      - choice:
        - text: Where would you like to visit?
        - Forest:
          - text: You head out to the snowy forest. It's cold, but you're prepared.
          - var foraging: forest
        - Meadow:
          - text: You leave the tower for the meadow. It is beautiful and sunny.
          - var foraging: meadow
        - Volcano:
          - text: You begin hiking toward the volcano. Lucky you know a heat shielding spell.
          - var foraging: volcano
        - Cave:
          - text: You begin your journey to the cave. Don't forget the lantern.
          - var foraging: cave
      - scene: leavingTower
    - Approach the Spell:
      - scene: approaching

approaching:
  - hide ALL: WITH FADE
  - text: You approach the spell...
  - call SpellCrafter: checkApproachSpell # this will set the {dead} and {barriersDelta} variable to be used in this section
  - show altar: WITH FADE

  - if ({dead}):
    - effect SHAKE:
    - text: The spell rushes past its final barrier and explodes outward. The last thing you see is a blinding flash of light... and then darkness.
    - scene: endGame

  - if ({barriersDelta} < 0):
    - effect SHAKE:
    - text: You see a barrier shatter and fall away. Only {barriers} remain holding the spell in place.
  - else:
    - text: The spell holds in place.

  - scene: interacting

interacting:
  - choice:
    - Add Component:
      - if ({itemCount} > 0):
        - call SpellCrafter: selectAndAddIngredient # This will set the {lastAddedItemName}, {chaosDelta}, {powerDelta} variables
        - text: You added {lastAddedItemName} to the spell
        - text: The chaos changed by {chaosDelta}. The power changed by {powerDelta}
      - else:
        - deuzi says angry: You don't have any components to add!!
        - hide deuzi: WITH FADE
      - scene: interacting
    - Leave:
      - scene: manageActions

leavingTower:
  # - show outside: WITH FADE
  # - show deuzi: normal AT CENTER WITH FADE
  # - deuzi says: I'll guard the tower while you're away.
  # - hide deuzi: WITH FADE
  # - text: "It will take 5:00 minutes to forage in the {foraging}"
  - if ({foraging} == "forest"):
      - scene: forest
  - if ({foraging} == "meadow"):
      - scene: meadow
  - if ({foraging} == "volcano"):
      - scene: volcano
  - if ({foraging} == "cave"):
      - scene: cave

forest:
  - show forest: WITH FADE
  - text: "You forage in the forest for several hours"
  - wait: 1000
  - call SpellCrafter: forage forest
  - text: You found 1 {lastForagedItemName}! {lastForagedItemFlavour}.
  - text: "{lastForagedItemDescription}"
  - text: Time to return to the tower.
  - scene: manageActions

meadow:
  - show meadow: WITH FADE
  - text: "You forage in the meadow for several hours"
  - wait: 1000
  - call SpellCrafter: forage meadow
  - text: You found 1 {lastForagedItemName}! {lastForagedItemFlavour}.
  - text: "{lastForagedItemDescription}"
  - text: Time to return to the tower.
  - scene: manageActions

volcano:
  - show volcano: WITH FADE
  - text: "You forage in the volcano for several hours"
  - wait: 1000
  - call SpellCrafter: forage volcano
  - text: You found 1 {lastForagedItemName}! {lastForagedItemFlavour}.
  - text: "{lastForagedItemDescription}"
  - text: Time to return to the tower.
  - scene: manageActions

cave:
  - show cave: WITH FADE
  - text: "You forage in the cave for several hours"
  - wait: 1000
  - call SpellCrafter: forage cave
  - text: You found 1 {lastForagedItemName}! {lastForagedItemFlavour}.
  - text: "{lastForagedItemDescription}"
  - text: Time to return to the tower.
  - scene: manageActions

endGame:
  - deuzi says normal: And that is the story of an unknown mage, who died in the pursuit of power greater than themselves...
  - deuzi says angry: Now on to my next victim!
  - hide ALL:
  - endgame:
